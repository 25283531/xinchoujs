**项目开发说明书：Windows单机版薪酬管理软件**

## 一、概述

本软件是一款面向单一公司、部署于Windows操作系统的本地化薪酬管理工具，提供灵活的社保与个税设置、薪酬项与薪酬组配置、员工与考勤数据导入、自动化工资计算与报表导出以及看板展示功能。全系统仅一位用户使用，拥有所有管理权限。系统数据采用SQLite存储，支持一键安装、自动更新、备份与恢复。

## 二、系统架构

* **客户端**：.NET/WPF或Electron等技术实现，响应式现代扁平风格（vflat）界面。
* **本地数据库**：SQLite。
* **安装包**：EXE/MSI，一键式安装，内置自动更新组件。
* **备份恢复**：本地文件方式，一键导出/导入数据库文件。

## 三、用户与权限

* **单一管理员**：系统仅一位用户，拥有全部权限，无角色区分。

## 四、核心功能

### 4.1 自定义字段与数据导入

* **自定义字段**：支持用户任意新增字段，并可选择字段类型（文本、数字、日期、下拉等），界面展示类型示例。
* **员工数据导入**：提供Excel/CSV模板下载，模板根据自定义字段动态生成；导入时可在映射界面将列与系统字段对应。
* **考勤与奖惩导入**：支持Excel格式文件导入，映射字段界面。

### 4.2 社保组与个税设置

* **社保组管理**：新增/编辑社保组，可配置养老、医疗、失业等项目；设置个人与公司缴纳比例。
* **个税速算公式**：预置主流地区公式，支持用户完全自定义公式（含速算扣除数、分级税率）。

### 4.3 薪酬项与薪酬组

* **薪酬项**：属性包括名称、类型（固定金额、百分比、公式）、金额或公式表达式。
* **薪酬组**：可将多种薪酬项组合，并为各项设定计算顺序；组内公式可跨项引用，但不支持条件逻辑。
* **分配规则**：按部门、职务或单独员工分配薪酬组，优先级：员工 > 职务 > 部门。

### 4.4 考勤异常与扣款

* **异常设置**：迟到、早退等项可按次定义；支持按小时或按天扣款。
* **扣款逻辑**：支持多段式规则（如首次免扣、2–5次按次、≥6次扣1天工资），两种扣款方式（固定金额或工资天数）二选一。
* **重新计算标记**：修改某员工某月异常后，标记「待重新计算」，并提醒用户。

### 4.5 工资计算与导出

* **一键计算**：点击后，依次读取社保/个税/薪酬组/考勤/奖惩设置，自动生成当月工资。
* **报表导出**：支持按部门、个人及总表三种Excel导出；支持PDF格式；支持自定义模板设计与保存。

### 4.6 数据看板

* **当月人力成本**：实时展示公司支出、员工实发、税收、社保费用四大指标。
* **成本变动**：环比上月数据对比。
* **仪表盘**：数字与简单折线/柱状图（无导出图片/PDF需求）。

## 五、用户界面设计

* **风格**：现代扁平（vflat），响应式布局，适配常见分辨率。
* **主模块导航**：侧边栏+顶部工具条。
* **数据导入/映射**：向导式步骤，表格预览与字段拖拽映射。
* **公式编辑器**：内嵌文本编辑区，高亮字段名与运算符。
* **看板**：卡片式布局，关键数值与简易图表。

## 六、非功能需求

* **性能**：5000人规模下，单次计算≤30秒。
* **安全**：本地存储，无网络传输；数据库文件可设置本地文件权限。
* **易用性**：模板、向导、示例提示。
* **可维护性**：模块化设计，配置文件驱动比例与公式。

## 七、部署与运维

* **安装包**：EXE/MSI，一键式安装。
* **自动更新**：内置检测与升级功能。
* **备份恢复**：SQLite数据库文件一键导出/导入。
* **日志**：本地日志文件，记录关键操作与错误。

## 八、错误处理与代码质量

### 8.1 错误处理机制

* **错误分类**：系统将错误分为数据库错误、业务逻辑错误、系统错误和其他错误四大类，每类包含多个子类型。
* **错误日志**：所有错误都会记录到日志系统，包含错误类型、时间、详细信息和堆栈跟踪。
* **异常捕获**：采用集中的错误处理机制，在业务阶段尽早处理异常，避免错误传播。
* **用户反馈**：在错误发生时提供友好的错误提示，并建议可能的解决方案。

### 8.2 数据库工具函数

* **表结构验证**：提供自动化的表和列存在性检查，确保数据库操作兼容不同版本的数据库结构。
* **动态SQL生成**：根据表结构自动构建插入和更新语句，适应字段变化。
* **安全事务处理**：提供统一的事务管理和回滚机制，确保数据完整性。
* **仓库基类**：所有数据库仓库类继承自基类，提供通用的查询、插入、更新和删除方法，并集成错误处理。

## 八、交付与后续

* **交付物**：安装包、用户手册、技术文档（包括API与数据字典）。
* **培训与支持**：提供培训PPT与1个月技术支持期。
* **迭代计划**：版本1.0上线后，根据用户反馈规划迭代功能。

---


